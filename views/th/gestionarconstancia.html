{{extend 'layout.html'}}

{{block head_css}}
<link rel="stylesheet" href="{{=URL('static', 'css/dataTables-1.10.13.min.css')}}">
<link rel="stylesheet" href="{{=URL('static','css/sweetalert.css')}}"/>
{{end}}

{{block head_js}}
<script src="{{=URL('static','js/dataTables-1.10.13.min.js')}}"></script>
<script src="{{=URL('static','js/sweetalert.min.js')}}"></script>
<script src="{{=URL('static','js/th/th.js')}}"></script>
{{end}}

{{block web2py_ajax}}{{end}}

<div class="container-fluid">
	<h1 class="text-center">Gestión de constancias</h1>
	<br /><br />
	<div class="table-responsive"> <!-- Permite la portabilidad de la tabla en dispositivos pequeños -->
		<table class="display solicitar-table">
			<thead class="bg-1">
				<tr>
					<td class="text-center">Carnet</td>
					<td class="text-center">Cédula</td>
					<td class="text-center">Nombres</td>
					<td class="text-center">Apellidos</td>
					<td class="text-center">Estado de solicitud</td>
					<td class="text-center"></td>
				</tr>
			</thead>
			<tbody>
				<tr align="center">
				    <td>{{=usuario.bombero.carnet}}</td>
				    <td>{{=usuario.persona.nacionalidad}}-{{=usuario.persona.cedula}}</td>
				    {{if usuario.persona.segundo_nombre != None:}}
		            <td>{{=usuario.persona.primer_nombre}} {{=usuario.persona.segundo_nombre}}</td>
		            {{else:}}
		            <td>{{=usuario.persona.primer_nombre}}</td>
		            {{pass}}
		            {{if usuario.persona.segundo_apellido != None:}}
		            <td>{{=usuario.persona.primer_apellido}} {{=usuario.persona.segundo_apellido}}</td>
		            {{else:}}
		            <td>{{=usuario.persona.primer_apellido}}</td>
		            {{pass}}
		            <td></td>
				    <td><button class="btn btn-sm bg-1" href="{{=URL('th','gestionarconstancia',args=['solicitar'])}}" type="button" id="btn-submit-solicitar"><span>Solicitar</span></td>
				    {{pass}}
				</tr>
			</tbody>
		</table>
	</div>
	<br /><br />
	{{if auth.has_permission('Gerencia'): }}
	<h2 class="text-left">Aprobación de constancias</h2>
	<div class="table-responsive"> <!-- Permite la portabilidad de la tabla en dispositivos pequeños -->
		<table class="display constancia-table">
			<thead class="bg-1">
				<tr>
					<td class="text-center">Carnet</td>
					<td class="text-center">Cédula</td>
					<td class="text-center">Nombres</td>
					<td class="text-center">Apellidos</td>
					<td class="text-center"></td>
					<td class="text-center"></td>
				</tr>
			</thead>
			<tbody>
				{{for row in tabla:}}
				<tr align="center">
				    <td>{{=row.bombero.carnet}}</td>
				    <td>{{=row.persona.nacionalidad}}-{{=row.persona.cedula}}</td>
				    {{if row.persona.segundo_nombre != None:}}
		            <td>{{=row.persona.primer_nombre}} {{=row.persona.segundo_nombre}}</td>
		            {{else:}}
		            <td>{{=row.persona.primer_nombre}}</td>
		            {{pass}}
		            {{if row.persona.segundo_apellido != None:}}
		            <td>{{=row.persona.primer_apellido}} {{=row.persona.segundo_apellido}}</td>
		            {{else:}}
		            <td>{{=row.persona.primer_apellido}}</td>
		            {{pass}}
				    <td><button class="btn btn-sm bg-1" href="{{=URL('th','gestionarconstancia',args=['aprobar',str(row.bombero.id)])}}" type="button" id="btn-submit-aprobar"><span>Aprobar</span></td>
				    <td><button class="btn btn-sm bg-1" href="{{=URL('th','gestionarconstancia',args=['cancelar',str(row.bombero.id)])}}" type="button" id="btn-submit-cancelar"><span>Cancelar</span></td>
				</tr>
				{{pass}}
			</tbody>
		</table>
	</div>
	{{pass}}
</div>